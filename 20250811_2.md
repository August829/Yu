# Vendor

HuangDou

# Product

UTCMS

# version

 V9

# Download 

https://github.com/usualtool/ut-cms

# Vulnerability

UTCMS V9 login function verification code bypasses vulnerability

# Description

The background login page of UTCMS V9 (app/modules/ut-frame/admin/login.php) has a logical flaw in verifying the verification code submitted by the user. Due to the loose == comparison operator used, and in some cases $_SESSION['authcode'] may be null, an attacker can bypass verification by submitting an empty verification code. "" == null is judged to be true in PHP, which completely invalidates the verification code mechanism. This allows attackers to perform dictionary attacks or brute force cracking on backend user accounts without restrictions.

# Analysis

1. Uninitialized Session: If the attacker does not access the verification code generation page (`captcha.php`) and sends a request directly to the login interface, `$_SESSION['authcode']` will not exist and its value is `null`. 
2. Loose comparison: The script uses `if($_SESSION['authcode']==$code)` for comparison. 
3. Type trick: When the attacker submits an empty `code` parameter, the `$code` variable is an empty string `"`. When PHP executes `"" == null`, it returns `true`, causing the verification logic to be bypassed.

<img width="1033" height="817" alt="image" src="https://github.com/user-attachments/assets/89b6ec3a-2de7-45ef-96de-4f9e44f7e63e" />

1. The attacker directly POST data to the login interface and does not include the `code` parameter or makes it empty.
2. Since the attacker never requested the verification code image, the server-side `$_SESSION['authcode']` has never been set and its value is `NULL`.
3. The server receives an empty `code` parameter, so the value of the `$code` variable is an empty string `""`.
4. Code execution `if (NULL == "")`.
5. PHP's type trick converts `NULL` to `""`, making the comparison become `if ("" == "")`.
6. The condition is judged as `true`, the verification code is successfully bypassed, and the code continues to execute the subsequent username and password verification logic.
In a sentence summary: The code incorrectly uses == to compare a Session variable that may be NULL and a user input that may be empty string, resulting in the verification code logic being completely bypassed.

We do the following reproduction, and the normal login situation:
<img width="1033" height="389" alt="image" src="https://github.com/user-attachments/assets/88e4309b-3929-49cf-bba2-13360fbe36b9" />


Delete the content of the code and make the code null
<img width="1030" height="497" alt="image" src="https://github.com/user-attachments/assets/757d0256-8c27-47d3-9971-f07ac75f41e7" />

Test can bypass the verification code and log in successfully
<img width="1033" height="502" alt="image" src="https://github.com/user-attachments/assets/dd6032fe-12fc-4ca0-90df-8c8fd3767edf" />




# POC
```
POST /app/dev/?m=ut-frame&p=login&do=login HTTP/1.1
Host: <Your-Target-IP-or-Domain>
Content-Type: application/x-www-form-urlencoded

username=admin&password=admin&code=
```

