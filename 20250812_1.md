### Summary
1panel_v2.0.8 command execution vulnerability.The OperateSSH function takes an operation parameter, which is directly passed to sshService.OperateSSH. 
Although the code for sshService is not visible, the function name and parameters (such as start, stop, restart) strongly suggest that this operation string might be used to construct a system command for execution, such as systemctl <operation> sshd. 
If the operation parameter is not strictly white-listed and validated, attackers could inject arbitrary commands. For example, sending stop; id might be executed as systemctl stop; id sshd, thus executing the id command.


### Details
In this path:
https://github.com/1Panel-dev/1Panel/blob/dev-v2/agent/app/api/v2/ssh.go

<img width="710" height="204" alt="12d49ded078b33b9f8def4e9e6970fe3_s_func=mbox:getComposeData sid=hFsRAvCCtfOSOOjCVgfligRRlJXqaxyF composeId=1754625471681 attachId=1" src="https://github.com/user-attachments/assets/60f61b6c-58ee-4883-878c-3747ba5fa88d" />


Proof follows:
<img width="1032" height="581" alt="493225095998512f6e1fc7d3893890e5_s_func=mbox:getComposeData sid=hFsRAvCCtfOSOOjCVgfligRRlJXqaxyF composeId=1754625471681 attachId=2" src="https://github.com/user-attachments/assets/bb3fba5c-25c4-4937-8702-cbdf45cac5f1" />


Successfully execute arbitrary commands, for example, create a new pwned file here.

<img width="639" height="131" alt="8fbce9d071a2aaa39436eb17d68c3e3f_s_func=mbox:getComposeData sid=hFsRAvCCtfOSOOjCVgfligRRlJXqaxyF composeId=1754625471681 attachId=3" src="https://github.com/user-attachments/assets/0c1223ff-160f-4d09-abc7-840f7d42e7ee" />


Repair recommendations:
1. Do not directly concatenate user input into command strings.
2. Use a strict whitelist to validate the `operation` parameter. Only allow expected values such as 'start', 'stop', 'restart'.
3. If `operation` is not on the whitelist, immediately reject the request.

```go
// Repair example
func (b *BaseApi) OperateSSH(c *gin.Context) {
    var req dto.Operate
    if err := helper.CheckBindAndValidate(&req, c); err != nil {
        return
    }

    // 白名单验证
    switch req.Operation {
    case "start", "stop", "restart":
        if err := sshService.OperateSSH(req.Operation); err != nil {
            helper.InternalServer(c, err)
            return
        }
    default:
        helper.BadRequest(c, errors.New("invalid operation"))
        return
    }

    helper.Success(c)
}
```

### PoC
POST /api/v2/hosts/ssh/operate HTTP/1.1
Host: <target_host>
Content-Type: application/json

{
  "operation": "restart; touch /tmp/pwned" 
}

### Impact
The OperateSSH function takes an operation parameter, which is directly passed to sshService.OperateSSH. 
Although the code for sshService is not visible, the function name and parameters (such as start, stop, restart) strongly suggest that this operation string might be used to construct a system command for execution, such as systemctl <operation> sshd. 
If the operation parameter is not strictly white-listed and validated, attackers could inject arbitrary commands. For example, sending stop; id might be executed as systemctl stop; id sshd, thus executing the id command.
