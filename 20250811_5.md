# Vendor

YiFang

# Product

YiFang CMS

# version

 2.0.5

# Download 

https://www.yifangcms.com

# Vulnerability

YiFang CMS latest version 2.0.5 No login required to leak database information

# Description

YiFang CMS latest version 2.0.5 (app/utils/base/database/Migrate.php) No login required to leak database information

# Analysis
Audits find that app/utils/base/database/Migrate.php does not require login to leak database information

1. Unauthorized access: This method can be accessed unrestrictedly through the `api/migrate/exportInstallTable` route. 
2. Information leakage: 
- The main function of this method is to export the structure (DDL) and data (DML) of specific tables in the database based on the incoming `database` and `version` parameters. 
- The `getMigrateData` method returns a predefined list of table names. 
- Loop through these tables, execute `show create table` and `select * from` to get the table structure and data. 
- Finally, the complete SQL script containing the `CREATE TABLE` and `INSERT INTO` statements is returned to the user.

<img width="766" height="516" alt="image" src="https://github.com/user-attachments/assets/57050173-0aca-48f1-8f4b-9d279f37a474" />
database and version controllable

And there is a mapping relationship here
<img width="686" height="617" alt="image" src="https://github.com/user-attachments/assets/9537acca-8c71-4ba0-a19f-8daa3cddd4aa" />

We try to make the value of database cms version init:
Database information can be leaked and exported without logging in here
<img width="1278" height="1356" alt="image" src="https://github.com/user-attachments/assets/e759a8c7-1d46-40b9-b739-54b1b8b2189a" />


# POC
```
http://192.168.1.88:8081/api/migrate/exportInstallTable?database=cms&version=init
```



