# Vendor

harness

# Product

harness

# version

v3.3.0

# Download 

https://github.com/harness/harness

# Vulnerability

Login Endpoint Brute-Force

# Description

The login endpoint /api/v1/login is indeed vulnerable to brute-force attacks, as it does not implement any anti-brute-force mechanisms such as rate limiting, CAPTCHA, or account lockout. users can attempt different password combinations an unlimited number of times until they find the correct one.


# Analysis

Reviewed the app/api/controller/user/login.go file. This file contains the implementation of the Controller.Login method, which is the core logic for handling user password-based login.

The following key points were identified:

1.​​User Lookup​​: It first attempts to find the user using LoginIdentifier (via UID or email).

2.Password Verification​​: Uses bcrypt.CompareHashAndPassword to verify whether the user-provided password matches the stored hashed password.

3.Error Handling​​:
•If the user is not found or the password does not match, it returns usererror.ErrNotFound. This is a security practice that prevents username enumeration.

4.​​Lack of Anti-Brute-Force Mechanisms​​:

•​​No Rate Limiting​​: In the Login method, no code is observed to limit login attempts from a single IP address, user, or within a specific time period.

•​​No CAPTCHA​​: There is no integration of CAPTCHA or other challenge-response mechanisms to distinguish between human users and automated scripts.

•​​No Account Lockout​​: Even after multiple failed login attempts, there is no indication that the user account will be locked.

•​​Endpoint​​: POST /api/v1/login

•​​Vulnerable Parameters​​: login_identifier and password.

•​​Code Path​​: app/router/api.go -> setupAccountWithoutAuth -> account.HandleLogin -> userCtrl.Login (app/api/controller/user/login.go)

Vulnerability Verification:

<img width="1059" height="927" alt="image" src="https://github.com/user-attachments/assets/48ad0451-a48b-4481-87ad-d000f3aeccc0" />

success:
<img width="1063" height="923" alt="image" src="https://github.com/user-attachments/assets/74293a46-89de-4d77-8007-10e8215a13f0" />


# POC
```
POST /api/v1/login?include_cookie=true HTTP/1.1
Host: 192.168.43.165:3000
Content-Length: 48

{"login_identifier":"xxx","password":"xxx"}

```
